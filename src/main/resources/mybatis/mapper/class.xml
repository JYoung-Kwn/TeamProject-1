<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mybatis.mapper.class">

<!-- 강사가 진행하고 있는 강의 목록 가져오기 -->
	<select id="selectTutorClass" parameterType="class" resultType="class">
		SELECT CLASS_NO,class_nm,class_thum, TUTOR_ID 
		FROM class 
		where TUTOR_ID=#{tutor_id}
	</select>
	
	
	
	
	<select id="selectClassesOrderByHot" resultType="class">
		select star.class_no,class.class_nm_s, class.CLASS_THUM, class_cate.class_cate_nm
		  from (select ROWNUM AS RNUM, review_star, class_no
        		  from (  select avg(review.REVIEW_STAR) as review_star, review.class_no as class_no 
				            from class, review
				           where class.CLASS_NO = review.CLASS_NO
				        group by review.class_no
				        order by avg(review.REVIEW_STAR) desc    )
  			  	) star, class, class_cate
		  where rnum &lt;=4
      		    and star.class_no =class.class_no
    		    and class.class_cate_no = class_cate.class_cate_no
	</select>
	
	
	<select id="selectClassesOrderByNew" resultType="class">
		select class_no, class_cate_nm, class_nm, class_nm_s, class_thum
		from (select rownum as rnum, class_no, class_cate_nm, class_nm,class_nm_s, class_thum
              from class, class_cate
              where class.class_cate_no = class_cate.class_cate_no
              order by CLASS_NO desc)
		where rnum &lt;=4 
	</select>
	
	
	
	
	<!-- 20.11.25 -->
	<!-- 20.11.27 별점 추가 -->
	<select id="selectbyClassNo" resultType="class" parameterType="int">
		select class.CLASS_NO, CLASS_NM, CLASS_SUB, CLASS_CURR, CLASS_THUM, TUTOR_ID, CLASS_CATE_NO, CLASS_VIDEO_NO, CLASS_PRICE, 
			   CLASS_TOT_TIME, CLASS_CURR2, CLASS_CURR3, CLASS_NM_S, member.mname, member.minfo, classreview.review_star  
		from class, member, (select avg(REVIEW_STAR) as review_star, review.class_no
                             from review
                             group by class_no) classreview
		where class.class_no = #{class_no}
		      and member.mid = class.TUTOR_ID
              and class.class_no = classreview.class_no
	</select>
	
	
	
	<!-- 20.11.26  -->
	<!-- tutor_id(mid)가 진행중인 강의 리스트 -->
	<select id="selectbyTutorId" parameterType="String" resultType="class">
		select class_no, class_nm, class_thum, class_nm_s
		from class 
		where tutor_id=#{tutor_id} 
	</select>
	

</mapper>